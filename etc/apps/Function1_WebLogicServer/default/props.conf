##############
# Index time event-breaking and timestamp extraction
##############

[source::...runWlstScriptsMinute.bat]
TRANSFORMS-wls_scripts_minute = send_to_nullqueue

[source::...runWlstScriptsHourly.bat]
TRANSFORMS-wls_scripts_hourly = send_to_nullqueue

[source::...runWlstScriptsDaily.bat]
TRANSFORMS-wls_scripts_daily = send_to_nullqueue

#Nix Data

[cpu]
SHOULD_LINEMERGE=false
LINE_BREAKER=^()$
TRUNCATE=1000000
DATETIME_CONFIG = CURRENT
REPORT-fields_for_cpu_sh = fields_for_cpu_sh

[ps]
SHOULD_LINEMERGE=false
LINE_BREAKER=^()$
TRUNCATE=1000000
DATETIME_CONFIG = CURRENT

[top]
SHOULD_LINEMERGE=false
LINE_BREAKER=^()$
TRUNCATE=1000000
DATETIME_CONFIG = CURRENT

[vmstat]
SHOULD_LINEMERGE=false
LINE_BREAKER=^()$
TRUNCATE=1000000
DATETIME_CONFIG = CURRENT
REPORTS-vmstat = vmstat_osx vmstat_linux
REPORT-fields_for_vmstat_sh = fields_for_vmstat_sh
FIELDALIAS-FreeMBytes = memFreeMB AS FreeMBytes
FIELDALIAS-UsedMBytes = memUsedMB AS UsedMBytes
FIELDALIAS-TotalMBytes = memTotalMB AS TotalMBytes

[hardware]
SHOULD_LINEMERGE=false
LINE_BREAKER=^()$
TRUNCATE=1000000
DATETIME_CONFIG = CURRENT
EXTRACT-RealMemoryMB = (?i)MEMORY_REAL\s+(?P<RealMemoryMB>[^ ]*)[ ]?
EXTRACT-SwapMemoryMB = (?i)MEMORY_SWAP\s+(?P<SwapMemoryMB>[^ ]*)[ ]?

[Perfmon:CPUTime_process]
FIELDALIAS-cpu_process = instance AS COMMAND Value AS pctCPU

# JMX 

[wls_win_jmx]
SHOULD_LINEMERGE = false
MAX_TIMESTAMP_LOOKAHEAD = 45
TIME_PREFIX = ^wls_jmx_timestamp=
TIME_FORMAT = %b %d, %Y %T &p %Z
LINE_BREAKER = ([\r\n]+)(?=wls_jmx_timestamp=\w{3}\s\d{1,2},\s\d{4}\s\d{2}:\d{2}:\d{2}\s\w{2}\s\w{3})
KV_MODE = none
pulldown_type = true

# WLS Native Log Files
[wls_managedserver]
SHOULD_LINEMERGE = true
BREAK_ONLY_BEFORE = #{4}<\w{3}\s\d{1,2},\s\d{4}\s\d{1,2}:\d{2}:\d{2}\s\w{2}
MAX_EVENTS = 2000
#Timestamp example from log: "####<Feb 14, 2012 12:03:14 AM EST>"
TIME_PREFIX = #{4}<
#From strptime spec, could possibly use "%r" to match 12-hour clock notation
TIME_FORMAT = %b %d, %Y %I:%M:%S %p

[wls_managedserver_access]
SHOULD_LINEMERGE = true
BREAK_ONLY_BEFORE = \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\s-\s-\s
TIME_PREFIX = \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\s-\s-\s\[
TIME_FORMAT = %d/%b/%Y:%H:%M:%S

[wls_managedserver_out]
SHOULD_LINEMERGE = true
BREAK_ONLY_BEFORE = <\w{3}\s\d{1,2},\s\d{4}\s\d{1,2}:\d{2}:\d{2}\s\w{2}
MAX_EVENTS = 2000
#TRUNCATE = 0
##Timestamp example: "<Jan 17, 2012 10:38:19 PM>" 
TIME_PREFIX = <
TIME_FORMAT = %b %d, %Y %I:%M:%S %p

[wls_adminserver]
SHOULD_LINEMERGE = true
BREAK_ONLY_BEFORE = #{4}<
MAX_EVENTS = 2000
#Timestamp example: "####<Jul 6, 2011 9:57:25 AM EDT>"
TIME_PREFIX = #{4}<
TIME_FORMAT = %b %d, %Y %I:%M:%S %p

[wls_adminserver_access]
SHOULD_LINEMERGE = true
BREAK_ONLY_BEFORE = \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\s-\s-\s
TIME_PREFIX = \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\s-\s-\s\[
TIME_FORMAT = %d/%b/%Y:%H:%M:%S

[wls_nodemanager]
SHOULD_LINEMERGE = true
BREAK_ONLY_BEFORE = <\w{3}\s\d{1,2},\s\d{4}\s\d{1,2}:\d{2}:\d{2}\s\w{2}
MAX_EVENTS = 2000
#TRUNCATE = 0
##Timestamp example: "<Jan 17, 2012 10:38:19 PM>" 
TIME_PREFIX = <
TIME_FORMAT = %b %d, %Y %I:%M:%S %p

[wls_nodemgrservice]
BREAK_ONLY_BEFORE = C:\\DOCUM
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = true

##############
# Search Time Field Extractions
##############

[wls_managedserver]
EXTRACT-managedserverlog = #{4}<\w{3}\s\d{1,2},\s\d{4}\s\d{1,2}:\d{2}:\d{2}\s\w{2}(\s\w{3})?>\s<(?P<severity>[^>]*)>\s<(?P<subsystem>[^>]*)>\s<(?P<machine_name>[^>]*)>\s<(?P<server>[^>]*)>\s<(?P<thread>[^>]*)>\s<(?P<user_id><?[^>]*>?)>\s<(?P<transaction_id>[^>]*)>\s<(?P<diag_context_id>[^>]*)>\s<(?P<raw_time_value>[^>]*)>\s<(?P<message_id>[^>]*)>\s<(?P<message_text>[^>]*)>
#The extraction below ensures that the core fields of the event are extracted: severity, subsystem, machine_name, and server
EXTRACT-managedserverlog_core = #{4}<\w{3}\s\d{1,2},\s\d{4}\s\d{1,2}:\d{2}:\d{2}\s\w{2}(\s\w{3})?>\s<(?P<severity>[^>]*)>\s<(?P<subsystem>[^>]*)>\s<(?P<machine_name>[^>]*)>\s<(?P<server>[^>]*)>
EXTRACT-firstrootexception = (?i)(?P<first_root_exception>[\w.]*[\.][\w]*exception)
EXTRACT-lastcausedbyexception = (?i)\s*caused\sby:\s*(?P<last_caused_by_exception>((([\w\.]+[\w.]exception[\w\.]*)|([\w\.]*exception[\w\.][\w\.]))))(?![\s\S]*caused\sby:\s*)
EXTRACT-svrstate=<Server\sstate\schanged\sto\s(?P<svstate>\w+)
KV_MODE = none

[wls_adminserver]
EXTRACT-adminserverlog = #{4}<\w{3}\s\d{1,2},\s\d{4}\s\d{1,2}:\d{2}:\d{2}\s\w{2}(\s\w{3})?>\s<(?P<severity>[^>]*)>\s<(?P<subsystem>[^>]*)>\s<(?P<machine_name>[^>]*)>\s<(?P<server>[^>]*)>\s<(?P<thread>[^>]*)>\s<(?P<user_id><?[^>]*>?)>\s<(?P<transaction_id>[^>]*)>\s<(?P<diag_context_id>[^>]*)>\s<(?P<raw_time_value>[^>]*)>\s<(?P<message_id>[^>]*)>\s<(?P<message_text>[^>]*)>	
#The extraction below ensures that the core fields of the event are extracted: severity, subsystem, machine_name, and server
EXTRACT-adminserverlog_core = #{4}<\w{3}\s\d{1,2},\s\d{4}\s\d{1,2}:\d{2}:\d{2}\s\w{2}(\s\w{3})?>\s<(?P<severity>[^>]*)>\s<(?P<subsystem>[^>]*)>\s<(?P<machine_name>[^>]*)>\s<(?P<server>[^>]*)>
EXTRACT-firstrootexception = (?i)(?P<first_root_exception>[\w.]*[\.][\w]*exception)
EXTRACT-lastcausedbyexception = (?i)\s*caused\sby:\s*(?P<last_caused_by_exception>((([\w\.]+[\w.]exception[\w\.]*)|([\w\.]*exception[\w\.][\w\.]+))))(?![\s\S]*caused\sby:\s*)
EXTRACT-free_mem=<BEA-310002>\s<(?P<free_mem>\d{1,3})\%\sof\sthe\stotal\smemory
EXTRACT-jms=<JMS>.+<Default\sconnection\sfactory\s"(?P<jmsq>\w+)"\swith\sits\sJNDI\sname\s"(?P<jms_jndi>[\w\.]+)"\s(?P<jms_jndi_msg>[\w\s]+)\.>
#KV_MODE = none


[wls_jmx]
#EXTRACT-wls_jmx_server = wls_jmx_server=(?P<wls_jmx_server>\w+)
#EXTRACT-wls_jmx_server_state = wls_jmx_server_state=(?P<wls_jmx_server_state>\w+)
#EXTRACT-wls_jmx_app = wls_jmx_app=(?P<wls_jmx_app>\w+)
#EXTRACT-wls_jmx_app_state = wls_jmx_app_state=(?P<wls_jmx_app_state>\w+)
#EXTRACT-wls_jmx_completed_reqs = wls_jmx_completed_reqs=(?P<wls_jmx_completed_reqs>\d+)
#EXTRACT-wls_jmx_server_health = wls_jmx_server_health=(?P<wls_jmx_server_health>\w+:\w+)
#EXTRACT-wls_jmx_throughput = wls_jmx_throughput=(?P<wls_jmx_throughput>\d+.\d+)
#EXTRACT-wls_jmx_total_threads = wls_jmx_total_threads=(<wls_jmx_total_threads>?P\d+)
#EXTRACT-wls_jmx_server_port = wls_jmx_server_port=(?P<wls_jmx_server_port>\d{1,5})
#EXTRACT-wls_jmx_pending_reqs = wls_jmx_pending_reqs=(?P<wls_jmx_pending_reqs>\d+)
#EXTRACT-wls_jmx_hogging_threads = wls_jmx_hogging_threads=(?P<wls_jmx_hogging_threads>\d+)
#EXTRACT-wls_jmx_jms_total_connections = wls_jmx_jms_total_connections=(?P<wls_jmx_jms_total_connections>\d+)
#EXTRACT-wls_jmx_jms_destination_count = wls_jmx_jms_destination_count=(?P<wls_jmx_jms_destination_count>\d+)
#REPORT = wls_script_field_extractions


##EXTRACTS ERROR CODES FOR LOOKUP TABLE TRANSLATION
[wls_adminserver]
EXTRACT-bea_code = BEA-(?P<bea_code>\d+)
LOOKUP-bea_action = wls_messages bea_code OUTPUT bea_action
LOOKUP-bea_cause = wls_messages bea_code OUTPUT bea_cause
#EXTRACT-free_mem = wls_free_mem=(?P<free_mem>\d+)

[wls_managedserver]
EXTRACT-bea_code = BEA-(?P<bea_code>\d+)
LOOKUP-bea_action = wls_messages bea_code OUTPUT bea_action
LOOKUP-bea_cause = wls_messages bea_code OUTPUT bea_cause

[wls_admin_adminserver]
EXTRACT-bea_code = BEA-(?P<bea_code>\d+)
LOOKUP-bea_action = wls_messages bea_code OUTPUT bea_action
LOOKUP-bea_cause = wls_messages bea_code OUTPUT bea_cause

[wls_managedserver]
EXTRACT-bea_code = BEA-(?P<bea_code>\d+)
LOOKUP-bea_action = wls_messages bea_code OUTPUT bea_action
LOOKUP-bea_cause = wls_messages bea_code OUTPUT bea_cause

[wls_managedserver_out]
EXTRACT-bea_code = BEA-(?P<bea_code>\d+)
LOOKUP-bea_action = wls_messages bea_code OUTPUT bea_action
LOOKUP-bea_cause = wls_messages bea_code OUTPUT bea_cause

[wls_managed_wciportal_out]
EXTRACT-bea_code = BEA-(?P<bea_code>\d+)
LOOKUP-bea_action = wls_messages bea_code OUTPUT bea_action
LOOKUP-bea_cause = wls_messages bea_code OUTPUT bea_cause

[wls_managed_wciportal_log]
EXTRACT-bea_code = BEA-(?P<bea_code>\d+)
LOOKUP-bea_action = wls_messages bea_code OUTPUT bea_action
LOOKUP-bea_cause = wls_messages bea_code OUTPUT bea_cause
