<form>
  <label>Meta Woot! First Time Report</label>
  <fieldset submitButton="false" autoRun="true">
    <input type="dropdown" token="index">
      <label>Index</label>
      <choice value="*">All</choice>
      <search>
        <query>| inputlookup meta_woot | dedup index | fields index | sort index</query>
      </search>
      <fieldForLabel>index</fieldForLabel>
      <fieldForValue>index</fieldForValue>
      <default>*</default>
    </input>
    <input type="dropdown" token="sourcetype" searchWhenChanged="true">
      <label>Sourcetype</label>
      <choice value="*">All</choice>
      <search>
        <query>| inputlookup meta_woot where index=$index$ | dedup sourcetype | fields sourcetype | sort sourcetype</query>
      </search>
      <fieldForLabel>sourcetype</fieldForLabel>
      <fieldForValue>sourcetype</fieldForValue>
      <default>*</default>
    </input>
    <input type="text" token="host" searchWhenChanged="true">
      <label>Host</label>
      <default>*</default>
    </input>
    <input type="dropdown" token="filter" searchWhenChanged="true">
      <label></label>
      <choice value="where firstTime&gt;(now()-3600)">firstTime in the last hour</choice>
      <choice value="where firstTime&gt;(now()-86400)">firstTime in the last 24 hours</choice>
      <choice value="where firstTime&gt;(now()-604800)">firstTime in the last week</choice>
      <choice value="where firstTime&gt;(now()-2592000)">firstTime in the last 30 days</choice>
      <default>where firstTime&gt;(now()-86400)</default>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>Results</title>
      <input type="dropdown" searchWhenChanged="true" token="fields">
        <label>Field Selection:</label>
        <choice value="stats min(firstTime) as firstTime, max(lastTime) as lastTime, max(recentTime) as recentTime by index sourcetype host">First Time Index, Sourcetype and Host</choice>
        <choice value="stats min(firstTime) as firstTime, max(lastTime) as lastTime, max(recentTime) as recentTime by index sourcetype">First Time Index and Sourcetype</choice>
        <choice value="stats min(firstTime) as firstTime, max(lastTime) as lastTime, max(recentTime) as recentTime by host">First Time Host</choice>
        <default>stats min(firstTime) as firstTime, max(lastTime) as lastTime, max(recentTime) as recentTime by index sourcetype host</default>
      </input>
      <html>Click to drill down to event counts over time. firstTime is the first time that Meta Woot first saw the record. lastTime is the last timestamp of the last event. recentTime is the time the last event was actually indexed.</html>
      <table>
        <search>
          <query>| inputlookup meta_woot  where index=$index$ sourcetype=$sourcetype$ host=$host$ 
| $fields$
| $filter$  
| convert ctime(recentTime) ctime(firstTime) ctime(lastTime) ctime(lastUpdated)
| sort - firstTime limit=0</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="count">50</option>
        <option name="dataOverlayMode">heatmap</option>
        <option name="drilldown">row</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
        <drilldown target="NewWindow">
          <link>
            <![CDATA[
          meta_woot_trends?form.sourcetype=$row.sourcetype$&form.index=$row.index$&form.host=$row.host$
		]]>
          </link>
        </drilldown>
      </table>
    </panel>
  </row>
</form>