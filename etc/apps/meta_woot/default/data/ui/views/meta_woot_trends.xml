<form>
  <label>Meta Woot! Trends</label>
  <fieldset submitButton="false" autoRun="true">
    <input type="time" token="time" searchWhenChanged="true">
      <label>Time Range</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="dropdown" token="index">
      <label>Index</label>
      <choice value="*">All</choice>
      <search>
        <query>| inputlookup meta_woot | dedup index | fields index | sort index</query>
      </search>
      <fieldForLabel>index</fieldForLabel>
      <fieldForValue>index</fieldForValue>
      <default>*</default>
    </input>
    <input type="dropdown" token="sourcetype" searchWhenChanged="true">
      <label>Sourcetype</label>
      <choice value="*">All</choice>
      <search>
        <query>| inputlookup meta_woot where index=$index$ | dedup sourcetype | fields sourcetype | sort sourcetype</query>
      </search>
      <fieldForLabel>sourcetype</fieldForLabel>
      <fieldForValue>sourcetype</fieldForValue>
      <default>*</default>
    </input>
    <input type="text" token="host" searchWhenChanged="true">
      <label>Host</label>
      <default>*</default>
    </input>
    <input type="text" token="splunk_server" searchWhenChanged="true">
      <label>Indexer</label>
      <default>*</default>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>Top Indexes</title>
      <table>
        <search>
          <query>index=`meta_woot_read_summary` sourcetype=meta_woot orig_sourcetype!=stash orig_sourcetype=$sourcetype$ orig_host=$host$ orig_index=$index$ orig_splunk_server=$splunk_server$ | stats sum(count) as total_events min(_time) as minTime, max(_time) as maxTime by orig_index | sort  - total_events limit=10 | eval span=maxTime-minTime  | eval eps=round(total_events/span,2) | rename total_events as "Events", eps as "Avg EPS" orig_index AS index  | fields - minTime maxTime span</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
    <panel>
      <title>Top Sourcetypes</title>
      <table>
        <search>
          <query>index=`meta_woot_read_summary`  sourcetype=meta_woot orig_sourcetype!=stash orig_sourcetype=$sourcetype$ orig_host=$host$ orig_index=$index$  orig_splunk_server=$splunk_server$ | stats sum(count) as total_events min(_time) as minTime, max(_time) as maxTime by orig_sourcetype | sort  - total_events limit=10 | eval span=maxTime-minTime  | eval eps=round(total_events/span,2) | rename total_events as "Events", eps as "Avg EPS" orig_sourcetype AS sourcetype | fields - minTime maxTime span</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
    <panel>
      <title>Top Hosts</title>
      <table>
        <search>
          <query>index=`meta_woot_read_summary` sourcetype=meta_woot orig_sourcetype!=stash orig_sourcetype=$sourcetype$ orig_host=$host$ orig_index=$index$  orig_splunk_server=$splunk_server$ | stats sum(count) as total_events min(_time) as minTime, max(_time) as maxTime by orig_host | sort  - total_events limit=10 | eval span=maxTime-minTime  | eval eps=round(total_events/span,2) | rename total_events as "Events", eps as "Avg EPS" orig_host AS host | fields - minTime maxTime span</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
    <panel>
      <title>Top Indexers</title>
      <table>
        <search>
          <query>index=`meta_woot_read_summary` sourcetype=meta_woot orig_sourcetype!=stash orig_sourcetype=$sourcetype$ orig_host=$host$ orig_index=$index$  orig_splunk_server=$splunk_server$ | stats sum(count) as total_events min(_time) as minTime, max(_time) as maxTime by orig_splunk_server | sort  - total_events limit=10 | eval span=maxTime-minTime  | eval eps=round(total_events/span,2) | rename total_events as "Events", eps as "Avg EPS" orig_splunk_server AS splunk_server | fields - minTime maxTime span</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Top 20 Events Over Time</title>
      <input type="dropdown" token="display" searchWhenChanged="true">
        <label>Display</label>
        <choice value="sum(totalEvents) as totalEvents">Total Events</choice>
        <choice value="avg(eps) as eps">Average EPS</choice>
        <default>sum(totalEvents) as totalEvents</default>
      </input>
      <input type="dropdown" token="filter" searchWhenChanged="true">
        <label>Filter</label>
        <choice value="orig_sourcetype">By Sourcetype</choice>
        <choice value="orig_index">By Index</choice>
        <choice value="orig_host">By Host</choice>
        <choice value="orig_splunk_server">By Indexer</choice>
        <default>orig_index</default>
      </input>
      <input type="dropdown" token="span" searchWhenChanged="true">
        <label>Span</label>
        <choice value="300">5 mins</choice>
        <choice value="900">15 mins</choice>
        <choice value="1800">30 mins</choice>
        <choice value="3600">60 mins</choice>
        <choice value="14400">4 hours</choice>
        <choice value="21600">6 hours</choice>
        <choice value="43200">12 hours</choice>
        <choice value="86400">1 day</choice>
        <choice value="604800">1 week</choice>
        <default>1800</default>
      </input>
      <chart>
        <search>
          <query>index=`meta_woot_read_summary` sourcetype=meta_woot orig_sourcetype!=stash orig_sourcetype=$sourcetype$ orig_host=$host$ orig_index=$index$   orig_splunk_server=$splunk_server$ | bucket span=$span$s _time | stats sum(count) as totalEvents by $filter$ _time | eval eps=totalEvents/$span$ | timechart limit=20 span=$span$s $display$ by $filter$</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">bottom</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
</form>